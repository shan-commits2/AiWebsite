<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Geminisa</title>
  </head>
  <body>
    <div id="root"></div>
    <script>
      if (!localStorage.getItem('sessionId')) {
        localStorage.setItem('sessionId', crypto.randomUUID());
      }
      const sessionId = localStorage.getItem('sessionId');
      window.sessionId = sessionId;
      const originalFetch = window.fetch;
      window.fetch = async (input, init = {}) => {
        let url = typeof input === "string" ? input : input.url;
        init.headers = init.headers || {};
        const method = (init.method || "GET").toUpperCase();
        if (url.startsWith("/api")) {
          init.headers["X-Session-Id"] = sessionId;
          if (["POST","PATCH","DELETE"].includes(method)) {
            if (init.headers["Content-Type"] === "application/json") {
              const body = init.body ? JSON.parse(init.body) : {};
              body.sessionId = sessionId;
              init.body = JSON.stringify(body);
            }
          }
        }
        return originalFetch(url, init);
      };
    </script>
    <script type="module" src="/src/main.tsx"></script>
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>
  </body>
</html>
